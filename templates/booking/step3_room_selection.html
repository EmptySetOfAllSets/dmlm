{% extends "base.html" %}

{% block content %}
<h2>Выберите номер</h2>

<form method="POST" class="filter-form">
    <div class="form-group">
        <label>Дата заезда: <input type="date" name="check_in" value="{{ check_in }}" required></label>
        <label>Дата выезда: <input type="date" name="check_out" value="{{ check_out }}" required></label>
    </div>

    <div class="form-group">
        <label>Тип номера:
            <select name="room_type">
                <option value="all">Все типы</option>
                {% for type in room_types %}
                <option value="{{ type.id }}" 
                    {% if current_filters.room_type == type.id|string %}selected{% endif %}>
                    {{ type.type }}
                </option>
                {% endfor %}
            </select>
        </label>
    </div>

    <div class="form-group">
        <label>Макс. цена: <input type="number" name="max_price" 
                               value="{{ current_filters.max_price or '' }}" 
                               placeholder="Любая"></label>
    </div>

    <div class="form-group">
        <label>Мин. вместимость: <input type="number" name="min_capacity" 
                                    value="{{ current_filters.min_capacity or '' }}" 
                                    placeholder="Любая"></label>
    </div>

    <button type="submit" class="btn-filter">Применить фильтры</button>
</form>

{% if available_rooms %}
    <div class="room-list">
        {% for room in available_rooms %}
        <div class="room-card">
            <h3>Номер {{ room.number }}</h3>
            <p><strong>Тип:</strong> {{ room.room_type.type }}</p>
            <p><strong>Цена за ночь:</strong> {{ room.price }} руб.</p>
            <p><strong>Вместимость:</strong> {{ room.capacity }} чел.</p>
            <a href="{{ url_for('confirm_booking', room_id=room.id) }}" class="btn-book">Выбрать</a>
        </div>
        {% endfor %}
    </div>
{% else %}
    <p class="no-rooms">Нет доступных номеров по выбранным критериям.</p>
{% endif %}

<style>
    .filter-form {
        background: #f5f5f5;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
    }
    .form-group {
        margin-bottom: 15px;
    }
    .room-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
    }
    .room-card {
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 8px;
    }
    .btn-book {
        display: inline-block;
        background: #4CAF50;
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        border-radius: 4px;
    }
</style>
{% endblock %}