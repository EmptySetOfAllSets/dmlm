{% extends "admin/base.html" %}

{% block content %}
<div class="admin-tabs-container">
    <!-- –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫ -->
    <div class="admin-tabs">
        <button class="tab-btn active" onclick="openTab('rooms')">–ù–æ–º–µ—Ä–∞</button>
        <button class="tab-btn" onclick="openTab('bookings')">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</button>
        <button class="tab-btn" onclick="openTab('clients')">–ö–ª–∏–µ–Ω—Ç—ã</button>
        <button class="tab-btn" onclick="openTab('room-types')">–¢–∏–ø—ã –Ω–æ–º–µ—Ä–æ–≤</button>
    </div>

    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–æ–∫ -->
    <div id="rooms" class="tab-content" style="display: block;">
        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞–º–∏</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>–ù–æ–º–µ—Ä</th>
                    <th>–¢–∏–ø</th>
                    <th>–¶–µ–Ω–∞</th>
                    <th>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for room in rooms %}
                <tr>
                    <td>{{ room.number }}</td>
                    <td>{{ room.room_type.type }}</td>
                    <td>{{ room.price }}</td>
                    <td>{{ room.capacity }}</td>
                    <td class="actions">
                        <a href="{{ url_for('edit_room', id=room.id) }}" class="btn-edit">‚úèÔ∏è</a>
                        <a href="{{ url_for('delete_room', id=room.id) }}" 
                           onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –Ω–æ–º–µ—Ä?')" 
                           class="btn-delete">üóëÔ∏è</a>
                    </td>
                    
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="bookings" class="tab-content">
        <h2>–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π -->
        <div class="tab-actions">
            <a href="{{ url_for('add_booking') }}" class="btn btn-add">+ –î–æ–±–∞–≤–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
        </div>
        <table class="data-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–ù–æ–º–µ—Ä</th>
                    <th>–ö–ª–∏–µ–Ω—Ç</th>
                    <th>–ó–∞–µ–∑–¥</th>
                    <th>–í—ã–µ–∑–¥</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for booking in bookings %}
                <tr>
                    <td>{{ booking.id }}</td>
                    <td>{{ booking.room.number }} ({{ booking.room.type }})</td>
                    <td>{{ booking.client.name }}</td>
                    <td>{{ booking.check_in.strftime('%d.%m.%Y') }}</td>
                    <td>{{ booking.check_out.strftime('%d.%m.%Y') }}</td>
                    <td>
                        {% if booking.check_in > today %}
                        <span class="status future">–ü—Ä–µ–¥—Å—Ç–æ—è—â–µ–µ</span>
                        {% else %}
                        <span class="status active">–ê–∫—Ç–∏–≤–Ω–æ–µ</span>
                        {% endif %}
                    </td>
                    <td class="actions">
                        <a href="{{ url_for('edit_booking', id=booking.id) }}" class="btn-edit">‚úèÔ∏è</a>
                        <a href="{{ url_for('delete_booking', id=booking.id) }}" 
                           onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?')" 
                           class="btn-delete">üóëÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div class="archive-link">
            <a href="{{ url_for('booking_archive') }}">
                –ü–æ–∫–∞–∑–∞—Ç—å –∞—Ä—Ö–∏–≤–Ω—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ({{ past_bookings_count }})
            </a>
        </div>
    </div>

    <div id="clients" class="tab-content">
        <h2>–ö–ª–∏–µ–Ω—Ç—ã</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>–ò–º—è</th>
                    <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                    <th>Email</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for client in clients %}
                <tr>
                    <td>{{ client.name }}</td>
                    <td>{{ client.phone }}</td>
                    <td>{{ client.mail or '‚Äî' }}</td>
                    <td class="actions">
                        <a href="{{ url_for('edit_client', id=client.id) }}" class="btn-edit">‚úèÔ∏è</a>
                        <a href="{{ url_for('delete_client', id=client.id) }}" 
                           onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞?')" 
                           class="btn-delete">üóëÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="room-types" class="tab-content">
        <h2>–¢–∏–ø—ã –Ω–æ–º–µ—Ä–æ–≤</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–¢–∏–ø –Ω–æ–º–µ—Ä–∞</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for rt in room_types %}
                <tr>
                    <td>{{ rt.id }}</td>
                    <td>{{ rt.type }}</td>
                    <td class="actions">
                        <a href="{{ url_for('edit_room_type', id=rt.id) }}" class="btn-edit">‚úèÔ∏è</a>
                        <a href="{{ url_for('delete_room_type', id=rt.id) }}" 
                           onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–∏–ø –Ω–æ–º–µ—Ä–∞?')" 
                           class="btn-delete">üóëÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
function openTab(tabName) {
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
    const tabContents = document.getElementsByClassName("tab-content");
    for (let i = 0; i < tabContents.length; i++) {
        tabContents[i].style.display = "none";
    }
    
    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
    const tabButtons = document.getElementsByClassName("tab-btn");
    for (let i = 0; i < tabButtons.length; i++) {
        tabButtons[i].classList.remove("active");
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É
    document.getElementById(tabName).style.display = "block";
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
    event.currentTarget.classList.add("active");
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
    localStorage.setItem('activeTab', tabName);
}

// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    const savedTab = localStorage.getItem('activeTab');
    if (savedTab) {
        document.querySelector(`.tab-btn[onclick="openTab('${savedTab}')"]`).click();
    }
});
</script>
{% endblock %}